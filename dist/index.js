!function(t){function e(o){if(r[o])return r[o].exports;var a=r[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,o){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./dist/",e(e.s=7)}([function(t,e,r){"use strict";var o=r(1);e.a=function(t){return void 0===t.data&&(t.data={}),0!=t.loading&&o.a.show(),$.ajax({url:"http://gumx.top:90/"+t.url,data:t.data,type:"post",cache:!1,dataType:"json",success:function(e){0!=t.loading&&o.a.hide(),0==e.errCode?"function"==typeof t.success&&t.success(e):(0!=t.alert&&void 0!==e.errMsg&&layer.alert(e.errMsg,{title:"警告",icon:2,scrollbar:!1}),"function"==typeof t.error&&t.error(e))},error:function(e,r,a){200==e.status?setTimeout(function(){window.location.href="web_user_page_login.do"},500):(0!=t.loading&&o.a.hide(),"abort"!=a&&(0!=t.alert&&layer.alert("系统错误（链接中断）！",{title:"警告",icon:2,scrollbar:!1}),"function"==typeof t.error&&t.error()))},complete:function(e,r){"function"==typeof t.complete&&t.complete(r)}})}},function(t,e,r){"use strict";function o(){}o.prototype.show=function(){$("#loading").show()},o.prototype.hide=function(){$("#loading").hide()};var a=new o;e.a=a},,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r(8),a=r(10),n=r(11);new Vue({el:".l-main-container",data:{sort:[],text:[],contentView:"list",searchTitle:"",selectedSortId:-1,selectedText:null,page:n.a},mounted:function(){o.a.init()},created:function(){a.a.getSort(this.sort),a.a.getText(this.text,n.a,{})},computed:{selectedSort:function(){var t={id:-1,name:"全部"},e=this;return this.sort.forEach(function(r){if(e.selectedSortId==r.id)return void(t=r)}),t}},watch:{selectedSortId:function(t){this.searchText()}},methods:{sortName:function(t){var e="";return this.sort.forEach(function(r){if(t==r.id)return void(e=r.name)}),e},searchText:function(){this.selectedText=null,this.contentView="list",a.a.getText(this.text,n.a,{sort_id:this.selectedSortId,title:this.searchTitle}),console.log(),jQuery(".page").scrollTop()>250&&$(".page").scrollTop(250)},readText:function(t){this.contentView="text",this.selectedText=t,a.a.readText(t.id)}}})},function(t,e,r){"use strict";var o=r(9),a={COOKIE_THEME:"color-theme",$colorItems:$(".color-themes > li"),colors:{default:"main-default",cyan:"main-cyan",green:"main-green",red:"main-red",yellow:"main-yellow",blue:"main-blue"},init:function(){var t=this;t.curCookieTheme(),t.$colorItems.on("click",function(){t.$colorItems.removeClass("is-active"),$(this).addClass("is-active");var e=$(this).data("color");t.setTheme(e),t.replaceMarkerForMaps(e),t.replaceImages(e)}),$("[data-reset]").on("resetColors",function(){t.setTheme("default"),t.replaceMarkerForMaps("default"),t.replaceImages("default"),o.a.set(t.COOKIE_THEME,"default"),t.setActiveItem("default")})},curCookieTheme:function(){var t=o.a.get(this.COOKIE_THEME);t?(this.preloaderV1(t),this.setTheme(t),this.replaceMarkerForMaps(t),this.replaceImages(t),this.setActiveItem(t)):(this.pageShow(),this.preloaderV1("default"))},preloaderV1:function(t){var e=$(".color-theme-preloader");if(e.length){var r=this.replaceSrcForImg(t,e.attr("src")),o=new Image;o.src=r,o.onload=function(){e.attr("src",r).css("visibility","visible")}}},setActiveItem:function(t){this.$colorItems.removeClass("is-active"),this.$colorItems.each(function(){$(this).data("color")===t&&$(this).addClass("is-active")})},setTheme:function(t){var e=$("link[data-themecolor]"),r=e.data("themecolor"),a=e.attr("href");r!==t&&(a=a.replace(this.colors[r]+".css",this.colors[t]+".css"),e.data("themecolor",t),e.attr("href",a),o.a.get(this.COOKIE_THEME)!==t&&o.a.set(this.COOKIE_THEME,t))},replaceSrcForImg:function(t,e){var r=e.split("."),o=r[r.length-2].split("-");return o[o.length-1]===t?e:(o[o.length-1]=t,o=o.join("-"),r[r.length-2]=o,r.join("."))},replaceImages:function(t){var e=this,r=$(".color-theme"),o=r.length,a=0;r.each(function(){var r=new Image,n=e.replaceSrcForImg(t,$(this).attr("src"));if(!n)return void a++;$(this).attr("src",n),r.src=n,r.onload=function(){++a===o&&e.pageShow()}})},replaceMarkerForMaps:function(t){var e=this,r=$(".b-google-map.map-theme");if(r.length>0){var o=e.replaceSrcForImg(t,$(".marker-template").attr("src"));if(!o)return;$(".marker-template").attr("src",o),r.trigger("replace_marker")}$(".color-theme").each(function(){var e,r=$(this).attr("src").split("."),o=r[r.length-2].split("-");o[o.length-1]!==t&&(o[o.length-1]=t,o=o.join("-"),r[r.length-2]=o,e=r.join("."),$(this).attr("src",e))})},pageShow:function(){setTimeout(function(){$(".mask-l").animate({opacity:0},800,function(){$(this).css("display","none")})},400)}};e.a=a},function(t,e,r){"use strict";function o(t){var e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}function a(t,e,r){r=r||{};var o=r.expires;if("number"==typeof o&&o){var a=new Date;a.setTime(a.getTime()+1e3*o),o=r.expires=a}o&&o.toUTCString&&(r.expires=o.toUTCString()),e=encodeURIComponent(e);var n=t+"="+e;for(var i in r){n+="; "+i;var c=r[i];!0!==c&&(n+="="+c)}document.cookie=n}function n(t){a(t,"",{expires:-1})}e.a={get:o,set:a,del:n}},function(t,e,r){"use strict";function o(){this.api={sort:"admin/sort/query.api",text:"admin/text/query.api",read:"admin/text/read.api"},o.prototype.getSort=function(t){Object(a.a)({url:this.api.sort,success:function(e){t.splice(0,t.length),e.vals.forEach(function(e){t.push(e)})}})},o.prototype.getText=function(t,e,r){-1==r.sort_id&&(r.sort_id=""),r.page=e.currPage,r.pageSize=e.pageSize,Object(a.a)({url:this.api.text,data:r,success:function(r){t.splice(0,t.length),r.vals.forEach(function(e){t.push(e)}),e.totalCount=r.count}})},o.prototype.readText=function(t){Object(a.a)({url:this.api.read,data:{id:t},success:function(t){var e=t.val;e=e.replace("---summary---","> ").replace("---summary---","\n").replace(/&gt;/g,"> "),marked.setOptions({highlight:function(t){return hljs.highlightAuto(t).value}});var r=marked(e);r=r.replace(/&amp;lt;/g,"&lt;").replace(/&amp;gt;/g,"&gt;"),$("#textContent").html(r)}})}}var a=r(0);e.a=new o},function(t,e,r){"use strict";var o={currPage:1,pageSize:5,totalCount:0,totalPage:0},a={};Object.defineProperty(o,"totalCount",{get:function(){return a.totalCount},set:function(t){a.totalCount=t,o.totalPage=parseInt(t/o.pageSize)+(t%o.pageSize>0?1:0),console.log(o)}}),e.a=o}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXguanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDgxMzY0YjNlYzQyZmJjOTIzODc3Iiwid2VicGFjazovLy8uL3NyYy9jb21tb24vYWpheC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tbW9uL2xvYWRpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3dlYi9hcHAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3dlYi9qcy9jb2xvci10aGVtZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3dlYi9qcy9jb29raWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3dlYi9qcy9kYXRhLmpzIiwid2VicGFjazovLy8uL3NyYy93ZWIvanMvcGFnZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbG9hZGluZ19qc19fIiwianNvbiIsImRhdGEiLCJsb2FkaW5nIiwic2hvdyIsIiQiLCJhamF4IiwidXJsIiwidHlwZSIsImNhY2hlIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwiaGlkZSIsImVyckNvZGUiLCJhbGVydCIsImVyck1zZyIsImxheWVyIiwidGl0bGUiLCJpY29uIiwic2Nyb2xsYmFyIiwiZXJyb3IiLCJYTUxIdHRwUmVxdWVzdCIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsInN0YXR1cyIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJjb21wbGV0ZSIsIlhIUiIsIlRTIiwiTG9hZGluZyIsInZhbHVlIiwiX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19qc19jb2xvcl90aGVtZXNfanNfXyIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fanNfZGF0YV9qc19fIiwiX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19qc19wYWdlX2pzX18iLCJWdWUiLCJlbCIsInNvcnQiLCJ0ZXh0IiwiY29udGVudFZpZXciLCJzZWFyY2hUaXRsZSIsInNlbGVjdGVkU29ydElkIiwic2VsZWN0ZWRUZXh0IiwicGFnZSIsIm1vdW50ZWQiLCJpbml0IiwiY3JlYXRlZCIsImdldFNvcnQiLCJ0aGlzIiwiZ2V0VGV4dCIsImNvbXB1dGVkIiwic2VsZWN0ZWRTb3J0IiwiaWQiLCJ0aGF0IiwiZm9yRWFjaCIsImUiLCJ3YXRjaCIsIm52Iiwic2VhcmNoVGV4dCIsIm1ldGhvZHMiLCJzb3J0TmFtZSIsInNvcnRfaWQiLCJjb25zb2xlIiwibG9nIiwialF1ZXJ5Iiwic2Nyb2xsVG9wIiwicmVhZFRleHQiLCJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX2Nvb2tpZV9qc19fIiwiY29sb3JUaGVtZSIsIkNPT0tJRV9USEVNRSIsIiRjb2xvckl0ZW1zIiwiY29sb3JzIiwiZGVmYXVsdCIsImN5YW4iLCJncmVlbiIsInJlZCIsInllbGxvdyIsImJsdWUiLCJzZWxmIiwiY3VyQ29va2llVGhlbWUiLCJvbiIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJjdXJFbGVtZW50Iiwic2V0VGhlbWUiLCJyZXBsYWNlTWFya2VyRm9yTWFwcyIsInJlcGxhY2VJbWFnZXMiLCJzZXQiLCJzZXRBY3RpdmVJdGVtIiwicHJlbG9hZGVyVjEiLCJwYWdlU2hvdyIsImN1clRoIiwiJGNvbG9yVGhlbWVQcmVsb2FkZXIiLCJsZW5ndGgiLCJuZXdTcmMiLCJyZXBsYWNlU3JjRm9ySW1nIiwiYXR0ciIsInRlbXBJbWciLCJJbWFnZSIsInNyYyIsIm9ubG9hZCIsImNzcyIsInRoZW1lIiwiZWFjaCIsIiRsaW5rVGhlbWUiLCJjdXJUaGVtZSIsImF0dHJFbCIsInJlcGxhY2UiLCJjdXJTcmMiLCJzcGxpdCIsInNyY1VwZCIsImpvaW4iLCIkaW1nVGhlbWUiLCJpbWdUaGVtZU51bSIsImNvdW50SW1nIiwiaW1nIiwiJG1hcCIsInRyaWdnZXIiLCJzcmNOZXdUaGVtZSIsImFuaW1hdGUiLCJvcGFjaXR5IiwiZ2V0Q29va2llIiwibWF0Y2hlcyIsImRvY3VtZW50IiwiY29va2llIiwibWF0Y2giLCJSZWdFeHAiLCJkZWNvZGVVUklDb21wb25lbnQiLCJ1bmRlZmluZWQiLCJzZXRDb29raWUiLCJvcHRpb25zIiwiZXhwaXJlcyIsIkRhdGUiLCJzZXRUaW1lIiwiZ2V0VGltZSIsInRvVVRDU3RyaW5nIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwidXBkYXRlZENvb2tpZSIsInByb3BOYW1lIiwicHJvcFZhbHVlIiwiZGVsZXRlQ29va2llIiwiZGVsIiwiRGF0YSIsImFwaSIsInJlYWQiLCJ2YWxzIiwiX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19jb21tb25fYWpheF9qc19fIiwic3BsaWNlIiwicHVzaCIsIm9wdGlvbiIsImN1cnJQYWdlIiwicGFnZVNpemUiLCJ0b3RhbENvdW50IiwiY291bnQiLCJ0ZXh0SWQiLCJjb250ZW50IiwidmFsIiwibWFya2VkIiwic2V0T3B0aW9ucyIsImhpZ2hsaWdodCIsImNvZGUiLCJobGpzIiwiaGlnaGxpZ2h0QXV0byIsImh0bWwiLCJ0b3RhbFBhZ2UiLCJ0ZW1wIiwicGFyc2VJbnQiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FJLEVBQUFKLEVBQ0FLLEdBQUEsRUFDQUgsV0FVQSxPQU5BSixHQUFBRSxHQUFBTSxLQUFB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eEosRUFBS3lKLFVBSzFCWCxFQUFLckosVUFBVXlFLFNBQVcsU0FBU3dGLEdBQ2xDMUssT0FBQWtLLEVBQUEsSUFDQzdJLElBQUkyQyxLQUFLK0YsSUFBSUMsS0FDYmhKLE1BQU1vRCxHQUFHc0csR0FDVGpKLFFBQVEsU0FBU1QsR0FDaEIsR0FBSTJKLEdBQVUzSixFQUFLNEosR0FDbkJELEdBQVVBLEVBQVFoRCxRQUFRLGdCQUFnQixNQUFNQSxRQUFRLGdCQUFnQixNQUFNQSxRQUFRLFFBQVEsTUFDOUZrRCxPQUFPQyxZQUNOQyxVQUFXLFNBQVVDLEdBQ3BCLE1BQU9DLE1BQUtDLGNBQWNGLEdBQU1qSSxRQUlsQyxJQUFJb0ksR0FBT04sT0FBT0YsRUFDbEJRLEdBQU9BLEVBQUt4RCxRQUFRLFlBQVksUUFBUUEsUUFBUSxZQUFZLFFBQzVEeEcsRUFBRSxnQkFBZ0JnSyxLQUFLQSxPUGdhTixHQUFJakIsR0FBZ0RoTCxFQUFvQixFT3paN0YyQixHQUFBLEtBQW1CaUosSVAyZGIsU0FBVXhLLEVBQVF1QixFQUFxQjNCLEdBRTdDLFlRdGhCQSxJQUFJeUUsSUFDSDJHLFNBQVcsRUFDWEMsU0FBVyxFQUNYQyxXQUFhLEVBQ2JZLFVBQVksR0FHVEMsSUFFSnJMLFFBQU9DLGVBQWUwRCxFQUFLLGNBQzFCdkQsSUFBSSxXQUNILE1BQU9pTCxHQUFLYixZQUViakUsSUFBSSxTQUFTcUUsR0FDWlMsRUFBS2IsV0FBYUksRUFDbEJqSCxFQUFLeUgsVUFBWUUsU0FBU1YsRUFBTWpILEVBQUs0RyxXQUFhSyxFQUFNakgsRUFBSzRHLFNBQVcsRUFBSSxFQUFJLEdBQ2hGekYsUUFBUUMsSUFBSXBCLE1BS2Q5QyxFQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi4vZGlzdC9cIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA3KTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19sb2FkaW5nX2pzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG4vKlxyXG5cdGpzb27kuK3nmoTlj4LmlbBcclxuXHR1cmw66K+35rGC5Zyw5Z2ALCBcdOS4jeiDveS4uuepulxyXG5cdGRhdGE65Y+C5pWwICAgICAgXHTlj6/ku6XkuLrnqbpcclxuXHRzdWNjZXNzOuaIkOWKn+eahOWbnuiwg+WHveaVsCDlj6/ku6XkuLrnqbogXHJcblx0ZXJyb3I6IOWksei0peeahOWbnuiwg+WHveaVsCDlj6/ku6XkuLrnqbpcclxuXHRsb2FkaW5nOiDmmK/lkKbpmpDol4/liqDovb3liqjnlLsg5Y+v5Lul5Li656m6XHTpu5jorqTmmL7npLogdHJ1ZS9mYWxzZVxyXG5cdGFsZXJ0OiDmmK/lkKbpmpDol4/plJnor6/mj5DnpLog5Y+v5Lul5Li656m6IOm7mOiupOaPkOekuiB0cnVlL2ZhbHNlXHJcblx0ICAgICAgICAgICAgXHJcblx0Ly/mqKHmnb9cclxuXHRhamF4KHtcclxuXHRcdHVybDpcIlwiLFxyXG5cdFx0ZGF0YTpkYXRhLFxyXG5cdFx0c3VjY2VzczpmdW5jdGlvbihkYXRhKXtcclxuXHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG4qL1xuXG4vLyB2YXIgbG9hZGluZyA9IHJlcXVpcmUoJy4vbG9hZGluZy5qcycpO1xuXG5cbi8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImFcIl0gPSAoZnVuY3Rpb24gKGpzb24pIHtcblx0aWYgKHR5cGVvZiBqc29uLmRhdGEgPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdGpzb24uZGF0YSA9IHt9O1xuXHR9XG5cblx0aWYgKGZhbHNlICE9IGpzb24ubG9hZGluZykge1xuXHRcdF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbG9hZGluZ19qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLnNob3coKTtcblx0fVxuXHR2YXIgYWpheCA9ICQuYWpheCh7XG5cdFx0dXJsOiBcImh0dHA6Ly9ndW14LnRvcDo5MC9cIiArIGpzb24udXJsLFxuXHRcdGRhdGE6IGpzb24uZGF0YSxcblx0XHR0eXBlOiAncG9zdCcsXG5cdFx0Y2FjaGU6IGZhbHNlLFxuXHRcdGRhdGFUeXBlOiAnanNvbicsXG5cdFx0c3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhkYXRhKSB7XG5cdFx0XHRpZiAoZmFsc2UgIT0ganNvbi5sb2FkaW5nKSB7XG5cdFx0XHRcdF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbG9hZGluZ19qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLmhpZGUoKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGRhdGEuZXJyQ29kZSA9PSAwKSB7XG5cdFx0XHRcdGlmICh0eXBlb2YganNvbi5zdWNjZXNzID09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHRcdGpzb24uc3VjY2VzcyhkYXRhKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKGZhbHNlICE9IGpzb24uYWxlcnQgJiYgdHlwZW9mIGRhdGEuZXJyTXNnICE9IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0XHRsYXllci5hbGVydChkYXRhLmVyck1zZywgeyB0aXRsZTogJ+itpuWRiicsIGljb246IDIsIHNjcm9sbGJhcjogZmFsc2UgfSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodHlwZW9mIGpzb24uZXJyb3IgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdFx0anNvbi5lcnJvcihkYXRhKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uIGVycm9yKFhNTEh0dHBSZXF1ZXN0LCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xuXHRcdFx0aWYgKFhNTEh0dHBSZXF1ZXN0LnN0YXR1cyA9PSAyMDApIHtcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIndlYl91c2VyX3BhZ2VfbG9naW4uZG9cIjtcblx0XHRcdFx0fSwgNTAwKTtcblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0aWYgKGZhbHNlICE9IGpzb24ubG9hZGluZykge1xuXHRcdFx0XHRcdF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbG9hZGluZ19qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLmhpZGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZXJyb3JUaHJvd24gIT0gXCJhYm9ydFwiKSB7XG5cdFx0XHRcdFx0aWYgKGZhbHNlICE9IGpzb24uYWxlcnQpIHtcblx0XHRcdFx0XHRcdGxheWVyLmFsZXJ0KCfns7vnu5/plJnor6/vvIjpk77mjqXkuK3mlq3vvInvvIEnLCB7IHRpdGxlOiAn6K2m5ZGKJywgaWNvbjogMiwgc2Nyb2xsYmFyOiBmYWxzZSB9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBqc29uLmVycm9yID09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHRcdFx0anNvbi5lcnJvcigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Y29tcGxldGU6IGZ1bmN0aW9uIGNvbXBsZXRlKFhIUiwgVFMpIHtcblx0XHRcdGlmICh0eXBlb2YganNvbi5jb21wbGV0ZSA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0anNvbi5jb21wbGV0ZShUUyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gYWpheDtcbn0pO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5mdW5jdGlvbiBMb2FkaW5nKCkge31cbkxvYWRpbmcucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XG5cdCQoXCIjbG9hZGluZ1wiKS5zaG93KCk7XG59O1xuXG5Mb2FkaW5nLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gKCkge1xuXHQkKFwiI2xvYWRpbmdcIikuaGlkZSgpO1xufTtcbnZhciBsb2FkaW5nID0gbmV3IExvYWRpbmcoKTtcbi8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImFcIl0gPSAobG9hZGluZyk7XG5cbi8qKiovIH0pLFxuLyogMiAqLyxcbi8qIDMgKi8sXG4vKiA0ICovLFxuLyogNSAqLyxcbi8qIDYgKi8sXG4vKiA3ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fd2VicGFja19leHBvcnRzX18sIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fanNfY29sb3JfdGhlbWVzX2pzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fanNfZGF0YV9qc19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19qc19wYWdlX2pzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblxuXG5cblxudmFyIGFwcCA9IG5ldyBWdWUoe1xuXHRlbDogXCIubC1tYWluLWNvbnRhaW5lclwiLFxuXHRkYXRhOiB7XG5cdFx0c29ydDogW10sXG5cdFx0dGV4dDogW10sXG5cdFx0Y29udGVudFZpZXc6IFwibGlzdFwiLCAvL3RleHQvbGlzdFxuXHRcdHNlYXJjaFRpdGxlOiBcIlwiLFxuXHRcdHNlbGVjdGVkU29ydElkOiAtMSxcblx0XHRzZWxlY3RlZFRleHQ6IG51bGwsXG5cdFx0cGFnZTogX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19qc19wYWdlX2pzX19bXCJhXCIgLyogZGVmYXVsdCAqL11cblx0fSxcblx0bW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHtcblx0XHRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX2pzX2NvbG9yX3RoZW1lc19qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLmluaXQoKTtcblx0fSxcblx0Y3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHtcblx0XHRfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX2pzX2RhdGFfanNfX1tcImFcIiAvKiBkZWZhdWx0ICovXS5nZXRTb3J0KHRoaXMuc29ydCk7XG5cdFx0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19qc19kYXRhX2pzX19bXCJhXCIgLyogZGVmYXVsdCAqL10uZ2V0VGV4dCh0aGlzLnRleHQsIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fanNfcGFnZV9qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLCB7fSk7XG5cdH0sXG5cdGNvbXB1dGVkOiB7XG5cdFx0c2VsZWN0ZWRTb3J0OiBmdW5jdGlvbiBzZWxlY3RlZFNvcnQoKSB7XG5cdFx0XHR2YXIgcyA9IHsgaWQ6IC0xLCBuYW1lOiBcIuWFqOmDqFwiIH07XG5cdFx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cdFx0XHR0aGlzLnNvcnQuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRpZiAodGhhdC5zZWxlY3RlZFNvcnRJZCA9PSBlLmlkKSB7XG5cdFx0XHRcdFx0cyA9IGU7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiBzO1xuXHRcdH1cblx0fSxcblx0d2F0Y2g6IHtcblx0XHRzZWxlY3RlZFNvcnRJZDogZnVuY3Rpb24gc2VsZWN0ZWRTb3J0SWQobnYpIHtcblx0XHRcdHRoaXMuc2VhcmNoVGV4dCgpO1xuXHRcdH1cblx0fSxcblx0bWV0aG9kczoge1xuXHRcdHNvcnROYW1lOiBmdW5jdGlvbiBzb3J0TmFtZShzb3J0X2lkKSB7XG5cdFx0XHR2YXIgcyA9IFwiXCI7XG5cdFx0XHR0aGlzLnNvcnQuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRpZiAoc29ydF9pZCA9PSBlLmlkKSB7XG5cdFx0XHRcdFx0cyA9IGUubmFtZTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHM7XG5cdFx0fSxcblx0XHRzZWFyY2hUZXh0OiBmdW5jdGlvbiBzZWFyY2hUZXh0KCkge1xuXHRcdFx0dGhpcy5zZWxlY3RlZFRleHQgPSBudWxsO1xuXHRcdFx0dGhpcy5jb250ZW50VmlldyA9IFwibGlzdFwiO1xuXHRcdFx0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19qc19kYXRhX2pzX19bXCJhXCIgLyogZGVmYXVsdCAqL10uZ2V0VGV4dCh0aGlzLnRleHQsIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fanNfcGFnZV9qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLCB7IHNvcnRfaWQ6IHRoaXMuc2VsZWN0ZWRTb3J0SWQsIHRpdGxlOiB0aGlzLnNlYXJjaFRpdGxlIH0pO1xuXHRcdFx0Y29uc29sZS5sb2coKTtcblx0XHRcdGlmIChqUXVlcnkoXCIucGFnZVwiKS5zY3JvbGxUb3AoKSA+IDI1MCkge1xuXHRcdFx0XHQkKFwiLnBhZ2VcIikuc2Nyb2xsVG9wKDI1MCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRyZWFkVGV4dDogZnVuY3Rpb24gcmVhZFRleHQodGV4dCkge1xuXHRcdFx0dGhpcy5jb250ZW50VmlldyA9IFwidGV4dFwiO1xuXHRcdFx0dGhpcy5zZWxlY3RlZFRleHQgPSB0ZXh0O1xuXHRcdFx0X19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19qc19kYXRhX2pzX19bXCJhXCIgLyogZGVmYXVsdCAqL10ucmVhZFRleHQodGV4dC5pZCk7XG5cdFx0fVxuXHR9XG59KTtcblxuLyoqKi8gfSksXG4vKiA4ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fY29va2llX2pzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXG52YXIgY29sb3JUaGVtZSA9IHtcbiAgICBDT09LSUVfVEhFTUU6ICdjb2xvci10aGVtZScsXG4gICAgJGNvbG9ySXRlbXM6ICQoJy5jb2xvci10aGVtZXMgPiBsaScpLFxuICAgIGNvbG9yczoge1xuICAgICAgICBkZWZhdWx0OiAnbWFpbi1kZWZhdWx0JyxcbiAgICAgICAgY3lhbjogJ21haW4tY3lhbicsXG4gICAgICAgIGdyZWVuOiAnbWFpbi1ncmVlbicsXG4gICAgICAgIHJlZDogJ21haW4tcmVkJyxcbiAgICAgICAgeWVsbG93OiAnbWFpbi15ZWxsb3cnLFxuICAgICAgICBibHVlOiAnbWFpbi1ibHVlJ1xuICAgIH0sXG4gICAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBzZWxmLmN1ckNvb2tpZVRoZW1lKCk7XG4gICAgICAgIHNlbGYuJGNvbG9ySXRlbXMub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi4kY29sb3JJdGVtcy5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgICAgIHZhciBjdXJFbGVtZW50ID0gJCh0aGlzKS5kYXRhKCdjb2xvcicpO1xuICAgICAgICAgICAgc2VsZi5zZXRUaGVtZShjdXJFbGVtZW50KTsgLy9yZXBsYWNlbWVudCBvZiBjb2xvciBlbGVtZW50c1xuICAgICAgICAgICAgc2VsZi5yZXBsYWNlTWFya2VyRm9yTWFwcyhjdXJFbGVtZW50KTtcbiAgICAgICAgICAgIHNlbGYucmVwbGFjZUltYWdlcyhjdXJFbGVtZW50KTsgLy9yZXBsYWNlbWVudCBwaWN0dXJlcyBmb3Igc3R5bGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnW2RhdGEtcmVzZXRdJykub24oJ3Jlc2V0Q29sb3JzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5zZXRUaGVtZSgnZGVmYXVsdCcpO1xuICAgICAgICAgICAgc2VsZi5yZXBsYWNlTWFya2VyRm9yTWFwcygnZGVmYXVsdCcpO1xuICAgICAgICAgICAgc2VsZi5yZXBsYWNlSW1hZ2VzKCdkZWZhdWx0Jyk7XG4gICAgICAgICAgICBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX2Nvb2tpZV9qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLnNldChzZWxmLkNPT0tJRV9USEVNRSwgJ2RlZmF1bHQnKTtcbiAgICAgICAgICAgIHNlbGYuc2V0QWN0aXZlSXRlbSgnZGVmYXVsdCcpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIGN1ckNvb2tpZVRoZW1lOiBmdW5jdGlvbiBjdXJDb29raWVUaGVtZSgpIHtcbiAgICAgICAgdmFyIGN1ckNvb2tpZVRoZW1lID0gX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19jb29raWVfanNfX1tcImFcIiAvKiBkZWZhdWx0ICovXS5nZXQodGhpcy5DT09LSUVfVEhFTUUpO1xuICAgICAgICBpZiAoY3VyQ29va2llVGhlbWUpIHtcbiAgICAgICAgICAgIHRoaXMucHJlbG9hZGVyVjEoY3VyQ29va2llVGhlbWUpO1xuICAgICAgICAgICAgdGhpcy5zZXRUaGVtZShjdXJDb29raWVUaGVtZSk7XG4gICAgICAgICAgICB0aGlzLnJlcGxhY2VNYXJrZXJGb3JNYXBzKGN1ckNvb2tpZVRoZW1lKTtcbiAgICAgICAgICAgIHRoaXMucmVwbGFjZUltYWdlcyhjdXJDb29raWVUaGVtZSk7XG4gICAgICAgICAgICB0aGlzLnNldEFjdGl2ZUl0ZW0oY3VyQ29va2llVGhlbWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYWdlU2hvdygpO1xuICAgICAgICAgICAgdGhpcy5wcmVsb2FkZXJWMSgnZGVmYXVsdCcpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBwcmVsb2FkZXJWMTogZnVuY3Rpb24gcHJlbG9hZGVyVjEoY3VyVGgpIHtcbiAgICAgICAgdmFyICRjb2xvclRoZW1lUHJlbG9hZGVyID0gJCgnLmNvbG9yLXRoZW1lLXByZWxvYWRlcicpO1xuICAgICAgICBpZiAoJGNvbG9yVGhlbWVQcmVsb2FkZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgbmV3U3JjID0gdGhpcy5yZXBsYWNlU3JjRm9ySW1nKGN1clRoLCAkY29sb3JUaGVtZVByZWxvYWRlci5hdHRyKCdzcmMnKSk7XG4gICAgICAgICAgICB2YXIgdGVtcEltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAgICAgdGVtcEltZy5zcmMgPSBuZXdTcmM7XG4gICAgICAgICAgICB0ZW1wSW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkY29sb3JUaGVtZVByZWxvYWRlci5hdHRyKCdzcmMnLCBuZXdTcmMpLmNzcygndmlzaWJpbGl0eScsICd2aXNpYmxlJyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBzZXRBY3RpdmVJdGVtOiBmdW5jdGlvbiBzZXRBY3RpdmVJdGVtKHRoZW1lKSB7XG4gICAgICAgIHRoaXMuJGNvbG9ySXRlbXMucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICAgICAgICB0aGlzLiRjb2xvckl0ZW1zLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCQodGhpcykuZGF0YSgnY29sb3InKSA9PT0gdGhlbWUpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBzZXRUaGVtZTogZnVuY3Rpb24gc2V0VGhlbWUodGhlbWUpIHtcbiAgICAgICAgdmFyICRsaW5rVGhlbWUgPSAkKCdsaW5rW2RhdGEtdGhlbWVjb2xvcl0nKSxcbiAgICAgICAgICAgIGN1clRoZW1lID0gJGxpbmtUaGVtZS5kYXRhKCd0aGVtZWNvbG9yJyksXG4gICAgICAgICAgICBhdHRyRWwgPSAkbGlua1RoZW1lLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgaWYgKGN1clRoZW1lID09PSB0aGVtZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGF0dHJFbCA9IGF0dHJFbC5yZXBsYWNlKHRoaXMuY29sb3JzW2N1clRoZW1lXSArICcuY3NzJywgdGhpcy5jb2xvcnNbdGhlbWVdICsgJy5jc3MnKTtcbiAgICAgICAgJGxpbmtUaGVtZS5kYXRhKCd0aGVtZWNvbG9yJywgdGhlbWUpO1xuICAgICAgICAkbGlua1RoZW1lLmF0dHIoJ2hyZWYnLCBhdHRyRWwpO1xuICAgICAgICBpZiAoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19jb29raWVfanNfX1tcImFcIiAvKiBkZWZhdWx0ICovXS5nZXQodGhpcy5DT09LSUVfVEhFTUUpICE9PSB0aGVtZSkge1xuICAgICAgICAgICAgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19jb29raWVfanNfX1tcImFcIiAvKiBkZWZhdWx0ICovXS5zZXQodGhpcy5DT09LSUVfVEhFTUUsIHRoZW1lKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcmVwbGFjZVNyY0ZvckltZzogZnVuY3Rpb24gcmVwbGFjZVNyY0ZvckltZyh0aGVtZSwgc3JjKSB7XG4gICAgICAgIHZhciBjdXJTcmMgPSBzcmMuc3BsaXQoJy4nKTtcbiAgICAgICAgdmFyIHNyY1VwZCA9IGN1clNyY1tjdXJTcmMubGVuZ3RoIC0gMl0uc3BsaXQoJy0nKTtcbiAgICAgICAgaWYgKHNyY1VwZFtzcmNVcGQubGVuZ3RoIC0gMV0gPT09IHRoZW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gc3JjO1xuICAgICAgICB9XG4gICAgICAgIHNyY1VwZFtzcmNVcGQubGVuZ3RoIC0gMV0gPSB0aGVtZTtcbiAgICAgICAgc3JjVXBkID0gc3JjVXBkLmpvaW4oJy0nKTtcbiAgICAgICAgY3VyU3JjW2N1clNyYy5sZW5ndGggLSAyXSA9IHNyY1VwZDtcbiAgICAgICAgcmV0dXJuIGN1clNyYy5qb2luKCcuJyk7XG4gICAgfSxcbiAgICByZXBsYWNlSW1hZ2VzOiBmdW5jdGlvbiByZXBsYWNlSW1hZ2VzKHRoZW1lKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyICRpbWdUaGVtZSA9ICQoJy5jb2xvci10aGVtZScpLFxuICAgICAgICAgICAgaW1nVGhlbWVOdW0gPSAkaW1nVGhlbWUubGVuZ3RoLFxuICAgICAgICAgICAgY291bnRJbWcgPSAwO1xuICAgICAgICAkaW1nVGhlbWUuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICB2YXIgbmV3U3JjID0gc2VsZi5yZXBsYWNlU3JjRm9ySW1nKHRoZW1lLCAkKHRoaXMpLmF0dHIoJ3NyYycpKTtcbiAgICAgICAgICAgIGlmICghbmV3U3JjKSB7XG4gICAgICAgICAgICAgICAgY291bnRJbWcrKztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ3NyYycsIG5ld1NyYyk7XG4gICAgICAgICAgICBpbWcuc3JjID0gbmV3U3JjO1xuICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb3VudEltZysrO1xuICAgICAgICAgICAgICAgIGlmIChjb3VudEltZyA9PT0gaW1nVGhlbWVOdW0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wYWdlU2hvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVwbGFjZU1hcmtlckZvck1hcHM6IGZ1bmN0aW9uIHJlcGxhY2VNYXJrZXJGb3JNYXBzKHRoZW1lKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyICRtYXAgPSAkKCcuYi1nb29nbGUtbWFwLm1hcC10aGVtZScpO1xuICAgICAgICBpZiAoJG1hcC5sZW5ndGggPiAwKSB7XG5cbiAgICAgICAgICAgIHZhciBuZXdTcmMgPSBzZWxmLnJlcGxhY2VTcmNGb3JJbWcodGhlbWUsICQoJy5tYXJrZXItdGVtcGxhdGUnKS5hdHRyKCdzcmMnKSk7XG4gICAgICAgICAgICBpZiAoIW5ld1NyYykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQoJy5tYXJrZXItdGVtcGxhdGUnKS5hdHRyKCdzcmMnLCBuZXdTcmMpO1xuICAgICAgICAgICAgJG1hcC50cmlnZ2VyKCdyZXBsYWNlX21hcmtlcicpO1xuICAgICAgICB9XG4gICAgICAgICQoJy5jb2xvci10aGVtZScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1clNyYyA9ICQodGhpcykuYXR0cignc3JjJykuc3BsaXQoJy4nKTtcbiAgICAgICAgICAgIHZhciBzcmNVcGQgPSBjdXJTcmNbY3VyU3JjLmxlbmd0aCAtIDJdLnNwbGl0KCctJyk7XG4gICAgICAgICAgICB2YXIgc3JjTmV3VGhlbWU7XG4gICAgICAgICAgICBpZiAoc3JjVXBkW3NyY1VwZC5sZW5ndGggLSAxXSA9PT0gdGhlbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzcmNVcGRbc3JjVXBkLmxlbmd0aCAtIDFdID0gdGhlbWU7XG4gICAgICAgICAgICBzcmNVcGQgPSBzcmNVcGQuam9pbignLScpO1xuICAgICAgICAgICAgY3VyU3JjW2N1clNyYy5sZW5ndGggLSAyXSA9IHNyY1VwZDtcbiAgICAgICAgICAgIHNyY05ld1RoZW1lID0gY3VyU3JjLmpvaW4oJy4nKTtcbiAgICAgICAgICAgICQodGhpcykuYXR0cignc3JjJywgc3JjTmV3VGhlbWUpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIHBhZ2VTaG93OiBmdW5jdGlvbiBwYWdlU2hvdygpIHtcblxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoJy5tYXNrLWwnKS5hbmltYXRlKHsgJ29wYWNpdHknOiAwIH0sIDgwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCA0MDApO1xuICAgIH1cblxufTtcblxuLy8gY29sb3JUaGVtZS5pbml0KCk7XG4vKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIF9fd2VicGFja19leHBvcnRzX19bXCJhXCJdID0gKGNvbG9yVGhlbWUpO1xuXG4vKioqLyB9KSxcbi8qIDkgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5mdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xuICAgIHZhciBtYXRjaGVzID0gZG9jdW1lbnQuY29va2llLm1hdGNoKG5ldyBSZWdFeHAoXCIoPzpefDsgKVwiICsgbmFtZS5yZXBsYWNlKC8oW1xcLiQ/Knx7fVxcKFxcKVxcW1xcXVxcXFxcXC9cXCteXSkvZywgJ1xcXFwkMScpICsgXCI9KFteO10qKVwiKSk7XG4gICAgcmV0dXJuIG1hdGNoZXMgPyBkZWNvZGVVUklDb21wb25lbnQobWF0Y2hlc1sxXSkgOiB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIHNldENvb2tpZShuYW1lLCB2YWx1ZSwgb3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgdmFyIGV4cGlyZXMgPSBvcHRpb25zLmV4cGlyZXM7XG5cbiAgICBpZiAodHlwZW9mIGV4cGlyZXMgPT0gXCJudW1iZXJcIiAmJiBleHBpcmVzKSB7XG4gICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgZC5zZXRUaW1lKGQuZ2V0VGltZSgpICsgZXhwaXJlcyAqIDEwMDApO1xuICAgICAgICBleHBpcmVzID0gb3B0aW9ucy5leHBpcmVzID0gZDtcbiAgICB9XG4gICAgaWYgKGV4cGlyZXMgJiYgZXhwaXJlcy50b1VUQ1N0cmluZykge1xuICAgICAgICBvcHRpb25zLmV4cGlyZXMgPSBleHBpcmVzLnRvVVRDU3RyaW5nKCk7XG4gICAgfVxuXG4gICAgdmFsdWUgPSBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpO1xuXG4gICAgdmFyIHVwZGF0ZWRDb29raWUgPSBuYW1lICsgXCI9XCIgKyB2YWx1ZTtcblxuICAgIGZvciAodmFyIHByb3BOYW1lIGluIG9wdGlvbnMpIHtcbiAgICAgICAgdXBkYXRlZENvb2tpZSArPSBcIjsgXCIgKyBwcm9wTmFtZTtcbiAgICAgICAgdmFyIHByb3BWYWx1ZSA9IG9wdGlvbnNbcHJvcE5hbWVdO1xuICAgICAgICBpZiAocHJvcFZhbHVlICE9PSB0cnVlKSB7XG4gICAgICAgICAgICB1cGRhdGVkQ29va2llICs9IFwiPVwiICsgcHJvcFZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuY29va2llID0gdXBkYXRlZENvb2tpZTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlQ29va2llKG5hbWUpIHtcbiAgICBzZXRDb29raWUobmFtZSwgXCJcIiwgeyBleHBpcmVzOiAtMSB9KTtcbn1cbi8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImFcIl0gPSAoe1xuICAgIGdldDogZ2V0Q29va2llLFxuICAgIHNldDogc2V0Q29va2llLFxuICAgIGRlbDogZGVsZXRlQ29va2llXG59KTtcblxuLyoqKi8gfSksXG4vKiAxMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX2NvbW1vbl9hamF4X2pzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cbmZ1bmN0aW9uIERhdGEoKSB7XG5cdHRoaXMuYXBpID0ge1xuXHRcdHNvcnQ6IFwiYWRtaW4vc29ydC9xdWVyeS5hcGlcIixcblx0XHR0ZXh0OiBcImFkbWluL3RleHQvcXVlcnkuYXBpXCIsXG5cdFx0cmVhZDogXCJhZG1pbi90ZXh0L3JlYWQuYXBpXCJcblx0fTtcblxuXHREYXRhLnByb3RvdHlwZS5nZXRTb3J0ID0gZnVuY3Rpb24gKHZhbHMpIHtcblx0XHRPYmplY3QoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19jb21tb25fYWpheF9qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dKSh7XG5cdFx0XHR1cmw6IHRoaXMuYXBpLnNvcnQsXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHtcblx0XHRcdFx0dmFscy5zcGxpY2UoMCwgdmFscy5sZW5ndGgpO1xuXHRcdFx0XHRkYXRhLnZhbHMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdHZhbHMucHVzaChlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0RGF0YS5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICh2YWxzLCBwYWdlLCBvcHRpb24pIHtcblx0XHRpZiAob3B0aW9uLnNvcnRfaWQgPT0gLTEpIHtcblx0XHRcdG9wdGlvbi5zb3J0X2lkID0gJyc7XG5cdFx0fVxuXHRcdG9wdGlvbi5wYWdlID0gcGFnZS5jdXJyUGFnZTtcblx0XHRvcHRpb24ucGFnZVNpemUgPSBwYWdlLnBhZ2VTaXplO1xuXHRcdE9iamVjdChfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX2NvbW1vbl9hamF4X2pzX19bXCJhXCIgLyogZGVmYXVsdCAqL10pKHtcblx0XHRcdHVybDogdGhpcy5hcGkudGV4dCxcblx0XHRcdGRhdGE6IG9wdGlvbixcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkge1xuXHRcdFx0XHR2YWxzLnNwbGljZSgwLCB2YWxzLmxlbmd0aCk7XG5cdFx0XHRcdGRhdGEudmFscy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdFx0dmFscy5wdXNoKGUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0cGFnZS50b3RhbENvdW50ID0gZGF0YS5jb3VudDtcblx0XHRcdH1cblx0XHR9KTtcblx0fTtcblxuXHREYXRhLnByb3RvdHlwZS5yZWFkVGV4dCA9IGZ1bmN0aW9uICh0ZXh0SWQpIHtcblx0XHRPYmplY3QoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19jb21tb25fYWpheF9qc19fW1wiYVwiIC8qIGRlZmF1bHQgKi9dKSh7XG5cdFx0XHR1cmw6IHRoaXMuYXBpLnJlYWQsXG5cdFx0XHRkYXRhOiB7IGlkOiB0ZXh0SWQgfSxcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uIHN1Y2Nlc3MoZGF0YSkge1xuXHRcdFx0XHR2YXIgY29udGVudCA9IGRhdGEudmFsO1xuXHRcdFx0XHRjb250ZW50ID0gY29udGVudC5yZXBsYWNlKFwiLS0tc3VtbWFyeS0tLVwiLCBcIj4gXCIpLnJlcGxhY2UoXCItLS1zdW1tYXJ5LS0tXCIsIFwiXFxuXCIpLnJlcGxhY2UoLyZndDsvZywgXCI+IFwiKTtcblx0XHRcdFx0bWFya2VkLnNldE9wdGlvbnMoe1xuXHRcdFx0XHRcdGhpZ2hsaWdodDogZnVuY3Rpb24gaGlnaGxpZ2h0KGNvZGUpIHtcblx0XHRcdFx0XHRcdHJldHVybiBobGpzLmhpZ2hsaWdodEF1dG8oY29kZSkudmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR2YXIgaHRtbCA9IG1hcmtlZChjb250ZW50KTtcblx0XHRcdFx0aHRtbCA9IGh0bWwucmVwbGFjZSgvJmFtcDtsdDsvZywgXCImbHQ7XCIpLnJlcGxhY2UoLyZhbXA7Z3Q7L2csIFwiJmd0O1wiKTtcblx0XHRcdFx0JChcIiN0ZXh0Q29udGVudFwiKS5odG1sKGh0bWwpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9O1xufVxuXG4vKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIF9fd2VicGFja19leHBvcnRzX19bXCJhXCJdID0gKG5ldyBEYXRhKCkpO1xuXG4vKioqLyB9KSxcbi8qIDExICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xudmFyIHBhZ2UgPSB7XG5cdGN1cnJQYWdlOiAxLFxuXHRwYWdlU2l6ZTogNSxcblx0dG90YWxDb3VudDogMCxcblx0dG90YWxQYWdlOiAwXG59O1xuXG52YXIgdGVtcCA9IHt9O1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkocGFnZSwgJ3RvdGFsQ291bnQnLCB7XG5cdGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHRcdHJldHVybiB0ZW1wLnRvdGFsQ291bnQ7XG5cdH0sXG5cdHNldDogZnVuY3Rpb24gc2V0KHZhbCkge1xuXHRcdHRlbXAudG90YWxDb3VudCA9IHZhbDtcblx0XHRwYWdlLnRvdGFsUGFnZSA9IHBhcnNlSW50KHZhbCAvIHBhZ2UucGFnZVNpemUpICsgKHZhbCAlIHBhZ2UucGFnZVNpemUgPiAwID8gMSA6IDApO1xuXHRcdGNvbnNvbGUubG9nKHBhZ2UpO1xuXHR9XG59KTtcblxuLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqLyBfX3dlYnBhY2tfZXhwb3J0c19fW1wiYVwiXSA9IChwYWdlKTtcblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBpbmRleC5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi4vZGlzdC9cIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA3KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA4MTM2NGIzZWM0MmZiYzkyMzg3NyIsIlxyXG4vKlxyXG5cdGpzb27kuK3nmoTlj4LmlbBcclxuXHR1cmw66K+35rGC5Zyw5Z2ALCBcdOS4jeiDveS4uuepulxyXG5cdGRhdGE65Y+C5pWwICAgICAgXHTlj6/ku6XkuLrnqbpcclxuXHRzdWNjZXNzOuaIkOWKn+eahOWbnuiwg+WHveaVsCDlj6/ku6XkuLrnqbogXHJcblx0ZXJyb3I6IOWksei0peeahOWbnuiwg+WHveaVsCDlj6/ku6XkuLrnqbpcclxuXHRsb2FkaW5nOiDmmK/lkKbpmpDol4/liqDovb3liqjnlLsg5Y+v5Lul5Li656m6XHTpu5jorqTmmL7npLogdHJ1ZS9mYWxzZVxyXG5cdGFsZXJ0OiDmmK/lkKbpmpDol4/plJnor6/mj5DnpLog5Y+v5Lul5Li656m6IOm7mOiupOaPkOekuiB0cnVlL2ZhbHNlXHJcblx0ICAgICAgICAgICAgXHJcblx0Ly/mqKHmnb9cclxuXHRhamF4KHtcclxuXHRcdHVybDpcIlwiLFxyXG5cdFx0ZGF0YTpkYXRhLFxyXG5cdFx0c3VjY2VzczpmdW5jdGlvbihkYXRhKXtcclxuXHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG4qL1xyXG5cclxuXHJcblxyXG5cclxuLy8gdmFyIGxvYWRpbmcgPSByZXF1aXJlKCcuL2xvYWRpbmcuanMnKTtcclxuXHJcbmltcG9ydCBsb2FkaW5nIGZyb20gJy4vbG9hZGluZy5qcyc7XHJcbmV4cG9ydCBkZWZhdWx0ICBmdW5jdGlvbihqc29uKXtcclxuXHRpZiAodHlwZW9mIGpzb24uZGF0YSA9PSBcInVuZGVmaW5lZFwiKSB7anNvbi5kYXRhID0ge307fVxyXG5cclxuXHRpZiAoZmFsc2UgIT0ganNvbi5sb2FkaW5nKSB7XHJcblx0XHRsb2FkaW5nLnNob3coKTtcclxuXHR9XHJcblx0dmFyIGFqYXggPSAkLmFqYXgoeyAgICBcclxuXHRcdHVybDpcImh0dHA6Ly9ndW14LnRvcDo5MC9cIitqc29uLnVybCxcclxuXHRcdGRhdGE6anNvbi5kYXRhLFxyXG5cdFx0dHlwZToncG9zdCcsXHJcblx0XHRjYWNoZTpmYWxzZSwgICAgXHJcblx0XHRkYXRhVHlwZTonanNvbicsICAgIFxyXG5cdFx0c3VjY2VzczpmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdGlmIChmYWxzZSAhPSBqc29uLmxvYWRpbmcpIHtcclxuXHRcdFx0XHRsb2FkaW5nLmhpZGUoKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKGRhdGEuZXJyQ29kZSA9PSAwKSB7XHJcblx0XHRcdFx0aWYgKHR5cGVvZiBqc29uLnN1Y2Nlc3MgPT0gXCJmdW5jdGlvblwiKXtcclxuXHRcdFx0XHRcdGpzb24uc3VjY2VzcyhkYXRhKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdGlmIChmYWxzZSAhPSBqc29uLmFsZXJ0ICYmIHR5cGVvZiBkYXRhLmVyck1zZyAhPSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHRcdFx0XHRsYXllci5hbGVydChkYXRhLmVyck1zZywge3RpdGxlIDon6K2m5ZGKJyxpY29uOiAyLHNjcm9sbGJhcjogZmFsc2V9KTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmICh0eXBlb2YganNvbi5lcnJvciA9PSBcImZ1bmN0aW9uXCIpIHtcclxuXHRcdFx0XHRcdGpzb24uZXJyb3IoZGF0YSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LCAgICBcclxuXHRcdGVycm9yIDogZnVuY3Rpb24oWE1MSHR0cFJlcXVlc3QsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XHJcblx0XHRcdGlmIChYTUxIdHRwUmVxdWVzdC5zdGF0dXMgPT0gMjAwKSB7XHJcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIndlYl91c2VyX3BhZ2VfbG9naW4uZG9cIjtcclxuXHRcdFx0XHR9LDUwMClcclxuXHRcdFx0fWVsc2V7XHJcblxyXG5cdFx0XHRcdGlmIChmYWxzZSAhPSBqc29uLmxvYWRpbmcpIHtcclxuXHRcdFx0XHRcdGxvYWRpbmcuaGlkZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZXJyb3JUaHJvd24gIT0gXCJhYm9ydFwiICkge1xyXG5cdFx0XHRcdFx0aWYgKGZhbHNlICE9IGpzb24uYWxlcnQpIHtcclxuXHRcdFx0XHRcdFx0bGF5ZXIuYWxlcnQoJ+ezu+e7n+mUmeivr++8iOmTvuaOpeS4reaWre+8ie+8gScsIHt0aXRsZSA6J+itpuWRiicsaWNvbjogMixzY3JvbGxiYXI6IGZhbHNlfSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAodHlwZW9mIGpzb24uZXJyb3IgPT0gXCJmdW5jdGlvblwiKSB7XHJcblx0XHRcdFx0XHRcdGpzb24uZXJyb3IoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRjb21wbGV0ZTpmdW5jdGlvbihYSFIsVFMpe1xyXG5cdFx0XHRpZiAodHlwZW9mIGpzb24uY29tcGxldGUgPT0gXCJmdW5jdGlvblwiKXtcclxuXHRcdFx0XHRqc29uLmNvbXBsZXRlKFRTKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuICAgIHJldHVybiBhamF4O1xyXG59XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbW1vbi9hamF4LmpzIiwiZnVuY3Rpb24gTG9hZGluZygpe31cclxuTG9hZGluZy5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uKCl7XHJcblx0JChcIiNsb2FkaW5nXCIpLnNob3coKTtcclxufVxyXG5cclxuTG9hZGluZy5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uKCl7XHJcblx0JChcIiNsb2FkaW5nXCIpLmhpZGUoKTtcclxufVxyXG52YXIgbG9hZGluZyA9IG5ldyBMb2FkaW5nO1xyXG5leHBvcnQgZGVmYXVsdCBsb2FkaW5nO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21tb24vbG9hZGluZy5qcyIsImltcG9ydCB0aGVtZSBmcm9tICcuL2pzL2NvbG9yLXRoZW1lcy5qcyc7XHJcbmltcG9ydCBkYXRhIGZyb20gJy4vanMvZGF0YS5qcyc7XHJcbmltcG9ydCBwYWdlIGZyb20gJy4vanMvcGFnZS5qcydcclxuXHJcblxyXG52YXIgYXBwID0gbmV3IFZ1ZSh7XHJcblx0ZWw6XCIubC1tYWluLWNvbnRhaW5lclwiLFxyXG5cdGRhdGE6e1xyXG5cdFx0c29ydDpbXSxcclxuXHRcdHRleHQ6W10sXHJcblx0XHRjb250ZW50VmlldzpcImxpc3RcIiwgLy90ZXh0L2xpc3RcclxuXHRcdHNlYXJjaFRpdGxlOlwiXCIsXHJcblx0XHRzZWxlY3RlZFNvcnRJZDotMSxcclxuXHRcdHNlbGVjdGVkVGV4dDpudWxsLFxyXG5cdFx0cGFnZTpwYWdlLFxyXG5cdH0sXHJcblx0bW91bnRlZDpmdW5jdGlvbigpe1xyXG5cdFx0dGhlbWUuaW5pdCgpO1xyXG5cdH0sXHJcblx0Y3JlYXRlZDpmdW5jdGlvbigpe1xyXG5cdFx0ZGF0YS5nZXRTb3J0KHRoaXMuc29ydCk7XHJcblx0XHRkYXRhLmdldFRleHQodGhpcy50ZXh0LHBhZ2Use30pO1xyXG5cdH0sXHJcblx0Y29tcHV0ZWQ6e1xyXG5cdFx0c2VsZWN0ZWRTb3J0OmZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciBzID0ge2lkOi0xLG5hbWU6XCLlhajpg6hcIn07XHJcblx0XHRcdHZhciB0aGF0ID0gdGhpcztcclxuXHRcdFx0dGhpcy5zb3J0LmZvckVhY2goZnVuY3Rpb24oZSl7XHJcblx0XHRcdFx0aWYgKHRoYXQuc2VsZWN0ZWRTb3J0SWQgPT0gZS5pZCkge1xyXG5cdFx0XHRcdFx0cyA9IGU7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0cmV0dXJuIHM7XHJcblx0XHR9LFxyXG5cdH0sXHJcblx0d2F0Y2g6e1xyXG5cdFx0c2VsZWN0ZWRTb3J0SWQ6ZnVuY3Rpb24gKG52KSB7XHJcblx0XHRcdHRoaXMuc2VhcmNoVGV4dCgpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblx0bWV0aG9kczp7XHJcblx0XHRzb3J0TmFtZTpmdW5jdGlvbihzb3J0X2lkKXtcclxuXHRcdFx0dmFyIHMgPSBcIlwiO1xyXG5cdFx0XHR0aGlzLnNvcnQuZm9yRWFjaChmdW5jdGlvbihlKXtcclxuXHRcdFx0XHRpZiAoc29ydF9pZCA9PSBlLmlkKSB7XHJcblx0XHRcdFx0XHRzID0gZS5uYW1lO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHJldHVybiBzO1xyXG5cdFx0fSxcclxuXHRcdHNlYXJjaFRleHQ6ZnVuY3Rpb24oKXtcclxuXHRcdFx0dGhpcy5zZWxlY3RlZFRleHQgPSBudWxsO1xyXG5cdFx0XHR0aGlzLmNvbnRlbnRWaWV3ID0gXCJsaXN0XCI7XHJcblx0XHRcdGRhdGEuZ2V0VGV4dCh0aGlzLnRleHQscGFnZSx7c29ydF9pZDp0aGlzLnNlbGVjdGVkU29ydElkLHRpdGxlOnRoaXMuc2VhcmNoVGl0bGV9KTtcclxuXHRcdFx0Y29uc29sZS5sb2coKTtcclxuXHRcdFx0aWYgKGpRdWVyeShcIi5wYWdlXCIpLnNjcm9sbFRvcCgpID4gMjUwKSB7JChcIi5wYWdlXCIpLnNjcm9sbFRvcCgyNTApO31cclxuXHRcdFx0XHJcblx0XHR9LFxyXG5cdFx0cmVhZFRleHQ6ZnVuY3Rpb24odGV4dCl7XHJcblx0XHRcdHRoaXMuY29udGVudFZpZXcgPSBcInRleHRcIjtcclxuXHRcdFx0dGhpcy5zZWxlY3RlZFRleHQgPSB0ZXh0O1xyXG5cdFx0XHRkYXRhLnJlYWRUZXh0KHRleHQuaWQpO1xyXG5cdFx0fSxcclxuXHR9LFxyXG59KVxyXG5cclxuXHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy93ZWIvYXBwLmpzIiwiaW1wb3J0IGNvb2tpZSBmcm9tICcuL2Nvb2tpZS5qcydcbnZhciBjb2xvclRoZW1lID0ge1xuICAgIENPT0tJRV9USEVNRTogJ2NvbG9yLXRoZW1lJyxcbiAgICAkY29sb3JJdGVtczogJCgnLmNvbG9yLXRoZW1lcyA+IGxpJyksXG4gICAgY29sb3JzOiB7XG4gICAgICAgIGRlZmF1bHQ6ICdtYWluLWRlZmF1bHQnLFxuICAgICAgICBjeWFuOiAnbWFpbi1jeWFuJyxcbiAgICAgICAgZ3JlZW46ICdtYWluLWdyZWVuJyxcbiAgICAgICAgcmVkOiAnbWFpbi1yZWQnLFxuICAgICAgICB5ZWxsb3c6ICdtYWluLXllbGxvdycsXG4gICAgICAgIGJsdWU6ICdtYWluLWJsdWUnXG4gICAgfSxcbiAgICBpbml0OiBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHNlbGYuY3VyQ29va2llVGhlbWUoKTtcbiAgICAgICAgc2VsZi4kY29sb3JJdGVtcy5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLiRjb2xvckl0ZW1zLnJlbW92ZUNsYXNzKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICAgICAgICAgICAgdmFyIGN1ckVsZW1lbnQgPSAkKHRoaXMpLmRhdGEoJ2NvbG9yJyk7XG4gICAgICAgICAgICAgICAgc2VsZi5zZXRUaGVtZShjdXJFbGVtZW50KTsgLy9yZXBsYWNlbWVudCBvZiBjb2xvciBlbGVtZW50c1xuICAgICAgICAgICAgICAgIHNlbGYucmVwbGFjZU1hcmtlckZvck1hcHMoY3VyRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgc2VsZi5yZXBsYWNlSW1hZ2VzKGN1ckVsZW1lbnQpOy8vcmVwbGFjZW1lbnQgcGljdHVyZXMgZm9yIHN0eWxlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAkKCdbZGF0YS1yZXNldF0nKS5vbigncmVzZXRDb2xvcnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLnNldFRoZW1lKCdkZWZhdWx0Jyk7XG4gICAgICAgICAgICBzZWxmLnJlcGxhY2VNYXJrZXJGb3JNYXBzKCdkZWZhdWx0Jyk7XG4gICAgICAgICAgICBzZWxmLnJlcGxhY2VJbWFnZXMoJ2RlZmF1bHQnKTtcbiAgICAgICAgICAgIGNvb2tpZS5zZXQoc2VsZi5DT09LSUVfVEhFTUUsICdkZWZhdWx0Jyk7XG4gICAgICAgICAgICBzZWxmLnNldEFjdGl2ZUl0ZW0oJ2RlZmF1bHQnKTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBjdXJDb29raWVUaGVtZTogZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGN1ckNvb2tpZVRoZW1lID0gY29va2llLmdldCh0aGlzLkNPT0tJRV9USEVNRSk7XG4gICAgICAgIGlmIChjdXJDb29raWVUaGVtZSkge1xuICAgICAgICAgICAgdGhpcy5wcmVsb2FkZXJWMShjdXJDb29raWVUaGVtZSk7XG4gICAgICAgICAgICB0aGlzLnNldFRoZW1lKGN1ckNvb2tpZVRoZW1lKTtcbiAgICAgICAgICAgIHRoaXMucmVwbGFjZU1hcmtlckZvck1hcHMoY3VyQ29va2llVGhlbWUpO1xuICAgICAgICAgICAgdGhpcy5yZXBsYWNlSW1hZ2VzKGN1ckNvb2tpZVRoZW1lKTtcbiAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlSXRlbShjdXJDb29raWVUaGVtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VTaG93KCk7XG4gICAgICAgICAgICB0aGlzLnByZWxvYWRlclYxKCdkZWZhdWx0Jyk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHByZWxvYWRlclYxOiBmdW5jdGlvbihjdXJUaCl7XG4gICAgICAgIHZhciAkY29sb3JUaGVtZVByZWxvYWRlciA9ICQoJy5jb2xvci10aGVtZS1wcmVsb2FkZXInKTtcbiAgICAgICAgaWYgKCRjb2xvclRoZW1lUHJlbG9hZGVyLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIG5ld1NyYyA9IHRoaXMucmVwbGFjZVNyY0ZvckltZyhjdXJUaCwgJGNvbG9yVGhlbWVQcmVsb2FkZXIuYXR0cignc3JjJykpO1xuICAgICAgICAgICAgdmFyIHRlbXBJbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIHRlbXBJbWcuc3JjID0gbmV3U3JjO1xuICAgICAgICAgICAgdGVtcEltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGNvbG9yVGhlbWVQcmVsb2FkZXIuYXR0cignc3JjJywgbmV3U3JjKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2V0QWN0aXZlSXRlbTogZnVuY3Rpb24odGhlbWUpe1xuICAgICAgICB0aGlzLiRjb2xvckl0ZW1zLnJlbW92ZUNsYXNzKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgdGhpcy4kY29sb3JJdGVtcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ2NvbG9yJykgPT09IHRoZW1lKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgc2V0VGhlbWU6IGZ1bmN0aW9uKHRoZW1lKXtcbiAgICAgICAgdmFyICRsaW5rVGhlbWUgPSAkKCdsaW5rW2RhdGEtdGhlbWVjb2xvcl0nKSxcbiAgICAgICAgY3VyVGhlbWUgPSAkbGlua1RoZW1lLmRhdGEoJ3RoZW1lY29sb3InKSxcbiAgICAgICAgYXR0ckVsID0gJGxpbmtUaGVtZS5hdHRyKCdocmVmJyk7XG4gICAgICAgIGlmIChjdXJUaGVtZSA9PT0gdGhlbWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBhdHRyRWwgPSBhdHRyRWwucmVwbGFjZSh0aGlzLmNvbG9yc1tjdXJUaGVtZV0gKyAnLmNzcycsIHRoaXMuY29sb3JzW3RoZW1lXSArICcuY3NzJyk7XG4gICAgICAgICRsaW5rVGhlbWUuZGF0YSgndGhlbWVjb2xvcicsIHRoZW1lKTtcbiAgICAgICAgJGxpbmtUaGVtZS5hdHRyKCdocmVmJywgYXR0ckVsKTtcbiAgICAgICAgaWYgKGNvb2tpZS5nZXQodGhpcy5DT09LSUVfVEhFTUUpICE9PSB0aGVtZSkge1xuICAgICAgICAgICAgY29va2llLnNldCh0aGlzLkNPT0tJRV9USEVNRSwgdGhlbWUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICByZXBsYWNlU3JjRm9ySW1nOiBmdW5jdGlvbih0aGVtZSwgc3JjKXtcbiAgICAgICAgdmFyIGN1clNyYyA9IHNyYy5zcGxpdCgnLicpO1xuICAgICAgICB2YXIgc3JjVXBkID0gY3VyU3JjW2N1clNyYy5sZW5ndGggLSAyXS5zcGxpdCgnLScpO1xuICAgICAgICBpZiAoc3JjVXBkW3NyY1VwZC5sZW5ndGggLSAxXSA9PT0gdGhlbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBzcmM7XG4gICAgICAgIH1cbiAgICAgICAgc3JjVXBkW3NyY1VwZC5sZW5ndGggLSAxXSA9IHRoZW1lO1xuICAgICAgICBzcmNVcGQgPSBzcmNVcGQuam9pbignLScpO1xuICAgICAgICBjdXJTcmNbY3VyU3JjLmxlbmd0aCAtIDJdID0gc3JjVXBkO1xuICAgICAgICByZXR1cm4gY3VyU3JjLmpvaW4oJy4nKTtcbiAgICB9LFxuICAgIHJlcGxhY2VJbWFnZXM6IGZ1bmN0aW9uKHRoZW1lKXtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgJGltZ1RoZW1lID0gJCgnLmNvbG9yLXRoZW1lJyksXG4gICAgICAgIGltZ1RoZW1lTnVtID0gJGltZ1RoZW1lLmxlbmd0aCxcbiAgICAgICAgY291bnRJbWcgPSAwO1xuICAgICAgICAkaW1nVGhlbWUuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICB2YXIgbmV3U3JjID0gc2VsZi5yZXBsYWNlU3JjRm9ySW1nKHRoZW1lLCAkKHRoaXMpLmF0dHIoJ3NyYycpKTtcbiAgICAgICAgICAgIGlmICghbmV3U3JjKSB7XG4gICAgICAgICAgICAgICAgY291bnRJbWcrKztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ3NyYycsIG5ld1NyYyk7XG4gICAgICAgICAgICBpbWcuc3JjID0gbmV3U3JjO1xuICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb3VudEltZysrO1xuICAgICAgICAgICAgICAgIGlmIChjb3VudEltZyA9PT0gaW1nVGhlbWVOdW0pIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wYWdlU2hvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVwbGFjZU1hcmtlckZvck1hcHM6IGZ1bmN0aW9uKHRoZW1lKXtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgJG1hcCA9ICQoJy5iLWdvb2dsZS1tYXAubWFwLXRoZW1lJyk7XG4gICAgICAgIGlmICgkbWFwLmxlbmd0aCA+IDApIHtcblxuICAgICAgICAgICAgdmFyIG5ld1NyYyA9IHNlbGYucmVwbGFjZVNyY0ZvckltZyh0aGVtZSwgJCgnLm1hcmtlci10ZW1wbGF0ZScpLmF0dHIoJ3NyYycpKTtcbiAgICAgICAgICAgIGlmICghbmV3U3JjKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJCgnLm1hcmtlci10ZW1wbGF0ZScpLmF0dHIoJ3NyYycsIG5ld1NyYyk7XG4gICAgICAgICAgICAkbWFwLnRyaWdnZXIoJ3JlcGxhY2VfbWFya2VyJyk7XG4gICAgICAgIH1cbiAgICAgICAgJCgnLmNvbG9yLXRoZW1lJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VyU3JjID0gJCh0aGlzKS5hdHRyKCdzcmMnKS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIHNyY1VwZCA9IGN1clNyY1tjdXJTcmMubGVuZ3RoIC0gMl0uc3BsaXQoJy0nKTtcbiAgICAgICAgICAgIHZhciBzcmNOZXdUaGVtZTtcbiAgICAgICAgICAgIGlmIChzcmNVcGRbc3JjVXBkLmxlbmd0aCAtIDFdID09PSB0aGVtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNyY1VwZFtzcmNVcGQubGVuZ3RoIC0gMV0gPSB0aGVtZTtcbiAgICAgICAgICAgIHNyY1VwZCA9IHNyY1VwZC5qb2luKCctJyk7XG4gICAgICAgICAgICBjdXJTcmNbY3VyU3JjLmxlbmd0aCAtIDJdID0gc3JjVXBkO1xuICAgICAgICAgICAgc3JjTmV3VGhlbWUgPSBjdXJTcmMuam9pbignLicpO1xuICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCdzcmMnLCBzcmNOZXdUaGVtZSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgcGFnZVNob3c6IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKCcubWFzay1sJykuYW5pbWF0ZSh7J29wYWNpdHknOiAwfSwgODAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIDQwMCk7XG4gICAgfVxuXG59O1xuXG4vLyBjb2xvclRoZW1lLmluaXQoKTtcbmV4cG9ydCBkZWZhdWx0IGNvbG9yVGhlbWU7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3dlYi9qcy9jb2xvci10aGVtZXMuanMiLCJmdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xuICAgIHZhciBtYXRjaGVzID0gZG9jdW1lbnQuY29va2llLm1hdGNoKG5ldyBSZWdFeHAoXG4gICAgICAgICAgICBcIig/Ol58OyApXCIgKyBuYW1lLnJlcGxhY2UoLyhbXFwuJD8qfHt9XFwoXFwpXFxbXFxdXFxcXFxcL1xcK15dKS9nLCAnXFxcXCQxJykgKyBcIj0oW147XSopXCJcbiAgICApKTtcbiAgICByZXR1cm4gbWF0Y2hlcyA/IGRlY29kZVVSSUNvbXBvbmVudChtYXRjaGVzWzFdKSA6IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gc2V0Q29va2llKG5hbWUsIHZhbHVlLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICB2YXIgZXhwaXJlcyA9IG9wdGlvbnMuZXhwaXJlcztcblxuICAgIGlmICh0eXBlb2YgZXhwaXJlcyA9PSBcIm51bWJlclwiICYmIGV4cGlyZXMpIHtcbiAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyBleHBpcmVzICogMTAwMCk7XG4gICAgICAgIGV4cGlyZXMgPSBvcHRpb25zLmV4cGlyZXMgPSBkO1xuICAgIH1cbiAgICBpZiAoZXhwaXJlcyAmJiBleHBpcmVzLnRvVVRDU3RyaW5nKSB7XG4gICAgICAgIG9wdGlvbnMuZXhwaXJlcyA9IGV4cGlyZXMudG9VVENTdHJpbmcoKTtcbiAgICB9XG5cbiAgICB2YWx1ZSA9IGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG5cbiAgICB2YXIgdXBkYXRlZENvb2tpZSA9IG5hbWUgKyBcIj1cIiArIHZhbHVlO1xuXG4gICAgZm9yKHZhciBwcm9wTmFtZSBpbiBvcHRpb25zKSB7XG4gICAgICAgIHVwZGF0ZWRDb29raWUgKz0gXCI7IFwiICsgcHJvcE5hbWU7XG4gICAgICAgIHZhciBwcm9wVmFsdWUgPSBvcHRpb25zW3Byb3BOYW1lXTtcbiAgICAgICAgaWYgKHByb3BWYWx1ZSAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgdXBkYXRlZENvb2tpZSArPSBcIj1cIiArIHByb3BWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRvY3VtZW50LmNvb2tpZSA9IHVwZGF0ZWRDb29raWU7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZUNvb2tpZShuYW1lKSB7XG4gICAgc2V0Q29va2llKG5hbWUsIFwiXCIsIHsgZXhwaXJlczogLTEgfSlcbn1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBnZXQ6Z2V0Q29va2llLFxuICAgIHNldDpzZXRDb29raWUsXG4gICAgZGVsOmRlbGV0ZUNvb2tpZSxcbn1cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvd2ViL2pzL2Nvb2tpZS5qcyIsImltcG9ydCBhamF4IGZyb20gJy4uLy4uL2NvbW1vbi9hamF4LmpzJztcclxuXHJcblxyXG5mdW5jdGlvbiBEYXRhKCl7XHJcblx0dGhpcy5hcGkgPSB7XHJcblx0XHRzb3J0OlwiYWRtaW4vc29ydC9xdWVyeS5hcGlcIixcclxuXHRcdHRleHQ6XCJhZG1pbi90ZXh0L3F1ZXJ5LmFwaVwiLFxyXG5cdFx0cmVhZDpcImFkbWluL3RleHQvcmVhZC5hcGlcIixcclxuXHR9O1xyXG5cclxuXHREYXRhLnByb3RvdHlwZS5nZXRTb3J0ID0gZnVuY3Rpb24odmFscyl7XHJcblx0XHRhamF4KHtcclxuXHRcdFx0dXJsOnRoaXMuYXBpLnNvcnQsXHJcblx0XHRcdHN1Y2Nlc3M6ZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0dmFscy5zcGxpY2UoMCx2YWxzLmxlbmd0aCk7XHJcblx0XHRcdFx0ZGF0YS52YWxzLmZvckVhY2goZnVuY3Rpb24oZSl7dmFscy5wdXNoKGUpfSk7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0fVxyXG5cclxuXHREYXRhLnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24odmFscyxwYWdlLG9wdGlvbil7XHJcblx0XHRpZiAob3B0aW9uLnNvcnRfaWQ9PS0xKSB7b3B0aW9uLnNvcnRfaWQ9Jyc7fVxyXG5cdFx0b3B0aW9uLnBhZ2UgPSBwYWdlLmN1cnJQYWdlO1xyXG5cdFx0b3B0aW9uLnBhZ2VTaXplID0gcGFnZS5wYWdlU2l6ZTtcclxuXHRcdGFqYXgoe1xyXG5cdFx0XHR1cmw6dGhpcy5hcGkudGV4dCxcclxuXHRcdFx0ZGF0YTpvcHRpb24sXHJcblx0XHRcdHN1Y2Nlc3M6ZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0dmFscy5zcGxpY2UoMCx2YWxzLmxlbmd0aCk7XHJcblx0XHRcdFx0ZGF0YS52YWxzLmZvckVhY2goZnVuY3Rpb24oZSl7dmFscy5wdXNoKGUpfSk7XHJcblx0XHRcdFx0cGFnZS50b3RhbENvdW50ID0gZGF0YS5jb3VudDtcdFx0XHRcdFxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdH1cclxuXHJcblx0RGF0YS5wcm90b3R5cGUucmVhZFRleHQgPSBmdW5jdGlvbih0ZXh0SWQpe1xyXG5cdFx0YWpheCh7XHJcblx0XHRcdHVybDp0aGlzLmFwaS5yZWFkLFxyXG5cdFx0XHRkYXRhOntpZDp0ZXh0SWR9LFxyXG5cdFx0XHRzdWNjZXNzOmZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0XHRcdHZhciBjb250ZW50ID0gZGF0YS52YWw7XHJcblx0XHRcdFx0Y29udGVudCA9IGNvbnRlbnQucmVwbGFjZShcIi0tLXN1bW1hcnktLS1cIixcIj4gXCIpLnJlcGxhY2UoXCItLS1zdW1tYXJ5LS0tXCIsXCJcXG5cIikucmVwbGFjZSgvJmd0Oy9nLFwiPiBcIik7XHJcblx0XHRcdFx0bWFya2VkLnNldE9wdGlvbnMoe1xyXG5cdFx0XHRcdFx0aGlnaGxpZ2h0OiBmdW5jdGlvbiAoY29kZSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gaGxqcy5oaWdobGlnaHRBdXRvKGNvZGUpLnZhbHVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHR2YXIgaHRtbCA9IG1hcmtlZChjb250ZW50KTtcclxuXHRcdFx0XHRodG1sID0gaHRtbC5yZXBsYWNlKC8mYW1wO2x0Oy9nLFwiJmx0O1wiKS5yZXBsYWNlKC8mYW1wO2d0Oy9nLFwiJmd0O1wiKVxyXG5cdFx0XHRcdCQoXCIjdGV4dENvbnRlbnRcIikuaHRtbChodG1sKTtcclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHR9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgRGF0YSgpO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy93ZWIvanMvZGF0YS5qcyIsInZhciBwYWdlID0ge1xyXG5cdGN1cnJQYWdlIDogMSxcclxuXHRwYWdlU2l6ZSA6IDUsXHJcblx0dG90YWxDb3VudCA6IDAsXHJcblx0dG90YWxQYWdlIDogMCxcclxufVxyXG5cclxudmFyIHRlbXAgPSB7fTtcclxuXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYWdlLCd0b3RhbENvdW50Jyx7XHJcblx0Z2V0OmZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gdGVtcC50b3RhbENvdW50O1xyXG5cdH0sXHJcblx0c2V0OmZ1bmN0aW9uKHZhbCl7XHJcblx0XHR0ZW1wLnRvdGFsQ291bnQgPSB2YWw7XHJcblx0XHRwYWdlLnRvdGFsUGFnZSA9IHBhcnNlSW50KHZhbCAvIHBhZ2UucGFnZVNpemUpICsgKHZhbCAlIHBhZ2UucGFnZVNpemUgPiAwID8gMSA6IDApO1xyXG5cdFx0Y29uc29sZS5sb2cocGFnZSk7XHJcblx0fVxyXG59KTtcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBwYWdlO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy93ZWIvanMvcGFnZS5qcyJdLCJzb3VyY2VSb290IjoiIn0=